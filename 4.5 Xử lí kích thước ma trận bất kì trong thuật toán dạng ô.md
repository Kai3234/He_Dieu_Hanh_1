Phép nhân ma trận dạng ô kernel trình bày trong 4.4 chỉ có thể xử lí ma trận có kích thước là bội số của chiều rộng ô vuông
# Mục tiêu
Để xử lí ma trận có kích thước bất kì trong phép nhân ma trận dạng ô
- Kiểm tra điều kiện biên khi tải các ô
- Điều chỉnh nội dung của [[ô]] để đơn giản hóa phép tính lõi
- Mở rộng kĩ thuật để xử lí ma trận hình chữ nhật

# Vấn đề của với ma trận có kích thước không chia hết chiều rộng ô 
## Ví dụ 3 x 3


![[Screenshot 2025-03-04 113614.png]]
<p style="text-align:center;">Hình 4.5.1 Pha 1 tải cho khối (0, 0)</p>

Các ma trận có kích thước 3 x 3, không phải là bội số của chiều rộng ô (2)
Ô mặt 0 hoàn toàn nằm trong phạm vi hợp lệ của cả M và N

Khi chuyển sang pha 1, chúng ta thấy rằng để [[tải ô]] M, chúng ta sẽ cố gắng tải hai phần tử M không hợp lệ trong ví dụ này. Vì vậy, luồng (0, 1) và luồng (1, 1) trong trường hợp này cần được xử lý đặc biệt khi tải gạch M.

Mặc dù về mặt khái niệm, hai luồng này đang tải các phần tử M không hợp lệ hoặc không tồn tại, nhưng trên thực tế, do bố cục hàng chính, các luồng này sẽ tải không chính xác các phần tử tiếp theo, là M1,0 và M2,0 trong trường hợp này, vào vị trí bộ nhớ chia sẻ của chúng.

Các phần tử được tải không chính xác này sẽ gây ra kết quả tính toán không chính xác nếu chúng ta sử dụng chúng trong tính toán tích vô hướng cho các phần tử P đó.

Bây giờ chúng ta hãy chuyển sự chú ý đến việc tải ô N. Việc tải ô N trong [[pha]] này sẽ liên quan đến [[luồng]] (1, 0) và [[luồng]] (1, 1) cố gắng tải các phần tử N không tồn tại.

Và điều này hơi khác so với trường hợp N vì các phần tử N không tồn tại đó sẽ hoàn toàn nằm ngoài phạm vi hợp lệ của dữ liệu N.

Vì vậy, trên hầu hết các phần cứng, điều này có thể gây ra vi phạm truy cập bộ nhớ vì chương trình đang cố gắng truy cập một vị trí không được cấp phát đúng cách. Điều đó có nghĩa là luồng 10 và luồng 11 cần được xử lý đặc biệt và chúng ta thực sự nên tránh thực hiện bất kỳ truy cập nào vào các vị trí đó.
## 2 trường hợp chính trong ví dụ trò chơi
# Một giải pháp "đơn giản"

# Ví dụ và triển khai

# Tóm tắt các quan sát

# Mở rộng cho ma trận hình chữ nhật

# Kết luận