# Mục tiêu
- Để hiểu thiết kế của thuật toán song song theo dạng ô cho phép nhân ma trận
	- Hiểu cách tải một ô dữ liệu (tile loading).
	- Hiểu quá trình thực thi theo pha (phased execution).
	- Hiểu cơ chế đồng bộ rào cản (barrier synchronization).
# Phép nhân ma trận
- Mô hình truy cập dữ liệu
	- Mỗi luồng xử lý một hàng của ma trận M và một cột của ma trận N.
	- Mỗi khối luồng (thread block) xử lý một dải của ma trận M và một dải của ma trận N.
![[Pasted image 20250219134255.png]]
# Phép nhân ma trận dạng ô
- Chia nhỏ quá trình thực thi của mỗi luồng thành các pha (phases).
- Trong mỗi pha, luồng chỉ truy cập một ô của ma trận M và một ô của ma trận N.
- Mỗi ô có kích thước là BLOCK_SIZE x BLOCK_SIZE.

![[Pasted image 20250219134957.png]]

# Tải một ô dữ liệu (Loading a Tile)
- Tất cả các luồng trong một khối đều tham gia vào quá trình tải dữ liệu
	-   Mỗi luồng tải một phần tử từ ma trận M và một phần tử  từ ma trận N vào bộ nhớ chia sẻ.
# Pha 0 - Tải dữ liệu cho khối (0,0)
- Dữ liệu từ M và N được nạp vào bộ nhớ chia sẻ.
- Mỗi luồng chịu trách nhiệm tải một phần tử.
![[Pasted image 20250219140622.png]]

# Pha 0 - Sử dụng dữ liệu trong khối (0,0) (lặp lại 0)
- Dữ liệu đã được tải vào bộ nhớ chia sẻ được sử dụng để tính toán kết quả.
- Các phần tử từ M và 
𝑁
N được kết hợp để tạo ra một phần của ma trận kết quả 
𝑃
P.
![[Pasted image 20250219140645.png]]

# Giai đoạn 0 Sử dụng cho Khối (0,0) (lặp lại 1)
![[Pasted image 20250219140700.png]]
# Tải giai đoạn 1 cho khối (0,0)
![[Pasted image 20250219140819.png]]
# Giai đoạn 1 Sử dụng cho Khối (0,0) (lặp lại 0)
![[Pasted image 20250219140859.png]]
# Giai đoạn 1 Sử dụng cho Khối (0,0) (lặp lại 1)
![[Pasted image 20250219140946.png]]
# Ví dụ về các giai đoạn thực hiện của đồ chơi 
![[Pasted image 20250219142259.png]]
![[Pasted image 20250219142323.png]]
- Bộ nhớ chia sẻ cho phép mỗi giá trị được truy cập bởi nhiều luồng
# Đồng bộ hóa rào cản
- Đồng bộ hóa tất cả các luồng trong một khối
	- syncthreads()
- Tất cả các luồng trong cùng một khối phải đạt đến__syncthreads() trước khi bất kỳ luồng nào trong số chúng có thể tiếp tục
- Được sử dụng tốt nhất để phối hợp các thuật toán xếp chồng thực hiện theo từng giai đoạn
	- Để đảm bảo rằng tất cả các thành phần của ô được tải vào đầu giai đoạn
	- Để đảm bảo rằng tất cả các thành phần của ô được sử dụng vào cuối giai đoạn
	